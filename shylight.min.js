!function(){function c(a,b){var e,h,i,c=a.textContent,d=window.getSelection(),g=!0;if(d.containsNode(a,!0)?(e=new Range,e.setStart(a,0),e.setEnd(d.anchorNode,d.anchorOffset),h=d.toString().length,i=e.toString().length):g=!1,Object.keys(b).forEach(function(a){c=c.replace(new RegExp(a,"g"),b[a].call?b[a]:function(c){return'<span class="'+b[a]+'">'+c+"</span>"})}),a.innerHTML=c,g){var j=f(a,i),k=f(a,i+h);e.setStart(j.node,j.offset),e.setEnd(k.node,k.offset),d.removeAllRanges(),d.addRange(e)}}function d(a){for(var b=a;!b.nextSibling;)b=b.parentElement;return e(b.nextSibling)}function e(a){if(a.nodeType==b)return a;for(var c=0;c<a.childNodes.length;c++){var d=e(a.childNodes[c]);if(d)return d}}function f(a,b){var c=e(a);if(!c)return{node:a,offset:0};for(var f=c.textContent.length;b>f;)c=d(c),f+=c.textContent.length;return{node:c,offset:c.textContent.length+b-f}}var b=3,g=function(a,b,d){a.setAttribute("contentEditable",!0),c(a,b),["keyup","paste","input","click"].forEach(function(e){a.addEventListener(e,function(){return c(a,b),d&&d(a.textContent),!0})})};"object"==typeof module&&"object"==typeof module.exports?module.exports=g:"function"==typeof define?define(function(){return g}):(window||global).shylight=g}();
